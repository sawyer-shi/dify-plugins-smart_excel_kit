# 智能多维表 (Smart Excel Kit)

一个强大的 Dify 插件，提供全面的**本地** Excel/CSV 数据分析和可视化功能。所有操作完全在您的本地机器上执行，除了您选择的大模型外无需任何外部服务，确保最大的数据安全性和隐私保护。支持由您首选的大模型驱动的文本分析、图片分析和图表生成功能。

## 版本信息

- **当前版本**: v0.0.1
- **发布日期**: 2026-01-24
- **兼容性**: Dify 插件框架
- **Python 版本**: 3.12

### 版本历史
- **v0.0.1** (2026-01-24): 初始版本，包含文本分析、图片分析和图表生成功能

## 快速开始

1. 从 Dify 应用市场下载 smart_excel_kit 插件
2. 在您的 Dify 环境中安装插件
3. 配置您首选的大模型
4. 立即开始分析您的 Excel/CSV 数据

## 核心特性

- **100% 本地处理**: 所有数据处理操作完全在您的本地机器上执行
- **灵活的大模型集成**: 使用您首选的大模型进行分析和可视化
- **无外部数据传输**: 您的数据永远不会离开本地环境（仅发送至您选择的大模型）
- **最高数据安全性**: 为您的敏感数据提供完整的隐私和安全保护
- **多种分析类型**: 一个工具集成文本分析、图片分析和图表生成
- **Excel 原生输出**: 所有结果以 Excel 文件形式输出，实现无缝集成
- **批处理支持**: 在单次操作中分析多列或多行数据

## 核心功能

### 文本分析

#### 单列文本分析 (single_column_text_analysis)
使用自定义提示词和大模型分析单列中的文本数据。
- **支持格式**: Excel (.xlsx, .xls), CSV
- **功能特性**:
  - 基于自定义提示词的分析
  - 灵活的列选择（单个单元格或范围）
  - 结果直接写入指定的输出列
  - 支持批处理
  - 保留原始文件结构

#### 多列文本分析 (multi_column_text_analysis)
使用自定义提示词分析和关联多列中的文本数据。
- **支持格式**: Excel (.xlsx, .xls), CSV
- **功能特性**:
  - 多列联合分析
  - 基于自定义提示词的关联分析
  - 支持范围的灵活列选择
  - 结果写入指定的输出列
  - 多行批处理

### 图片分析

#### 单列图片分析 (single_column_image_analysis)
使用视觉模型分析单列中引用的图片 URL。
- **支持格式**: Excel (.xlsx, .xls), CSV（包含图片 URL）
- **功能特性**:
  - 基于视觉模型的图片分析
  - 支持多种图片格式（PNG、JPG、JPEG、WEBP 等）
  - 基于自定义提示词的图片描述
  - 灵活的列选择
  - 结果写入指定的输出列

#### 多列图片分析 (multi_column_image_analysis)
使用视觉模型分析和关联多列中的多张图片。
- **支持格式**: Excel (.xlsx, .xls), CSV（包含图片 URL）
- **功能特性**:
  - 多图片联合分析
  - 基于视觉模型的关联分析
  - 基于自定义提示词的图片对比
  - 灵活的多列选择
  - 结果写入指定的输出列

### 图表生成

#### 图表生成器 (chart_generator)
基于您的数据和大模型分析自动生成各种类型的 Excel 图表。
- **支持的图表类型**:
  - 柱状图（簇状、堆积）
  - 条形图（水平）
  - 折线图（2D、3D）
  - 饼图
  - 圆环图
  - 面积图
  - 雷达图
  - 散点图（XY）
  - 气泡图
  - 曲面图（3D）
- **功能特性**:
  - 大模型驱动的图表类型选择
  - 自动数据范围检测
  - 智能图表定位
  - 多数据系列支持
  - 自定义图表标题和标签
  - 原生 Excel 图表对象

### 数据操作

#### Excel 操控器 (excel_manipulator)
使用 AI 智能修改、清洗或计算 Excel 数据，支持 Python Pandas 操作。
- **支持的操作**:
  - 数据清洗和过滤
  - 行/列操作
  - 计算列创建
  - 数据去重
  - 自定义数据转换
- **功能特性**:
  - 自然语言指令
  - AI 生成的 Python Pandas 代码
  - 完整的 Pandas 库支持
  - 保留 Excel 文件结构
  - 自定义输出文件名支持
  - 安全代码执行环境

## 技术优势

- **本地处理**: 所有文件操作在本地执行，确保数据隐私
- **大模型灵活性**: 兼容 Dify 支持的任何大模型
- **原生 Excel 集成**: 使用 openpyxl 实现无缝 Excel 文件操作
- **图片 URL 支持**: 自动下载和处理来自 URL 的图片
- **智能数据检测**: 自动检测数据类型和范围
- **错误处理**: 全面的错误处理和用户友好的提示信息
- **内存高效**: 针对大文件优化的流式处理

## 使用场景

### 内容分析
- 分析 Excel 列中的客户反馈或评论
- 使用大模型总结长文本内容
- 从文本数据中提取关键信息

### 图片处理
- 批量分析来自 URL 的产品图片
- 对比多张图片并生成描述
- 从图片数据集中提取视觉信息

### 数据可视化
- 从 Excel 数据生成销售图表
- 创建雷达图进行性能对比
- 构建散点图进行相关性分析
- 设计饼图展示数据分布

## 隐私与安全

- **本地优先架构**: 所有文件处理在本地完成
- **无数据保留**: 我们不存储或保留您的文件副本
- **仅发送至大模型**: 数据仅发送至您配置的大模型
- **无第三方服务**: 无需任何外部 API 或服务
- **安全临时文件**: 临时文件在处理后安全删除

## 许可证

本插件采用 Apache License 2.0 许可证。详情请参见 LICENSE 文件。

## 支持

如有问题、功能请求或贡献，请访问我们的 GitHub 仓库：
https://github.com/sawyer-shi/dify-plugins-smart_excel_kit
