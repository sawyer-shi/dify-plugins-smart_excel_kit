identity:
  author: "sawyer-shi"
  name: multi_column_text_analysis
  label:
    en_US: Multi Column Text Analysis--Output Excel
    zh_Hans: 多列文本信息分析--输出Excel
description:
  human:
    en_US: Analyze multiple columns of text.
    zh_Hans: 使用自定义提示词联合分析多列文本。
  llm: Analyze multiple columns of text.
class_name: MultiColumnTextAnalysisTool
parameters:
  - name: model_config
    type: model-selector
    scope: llm
    required: true
    label:
      en_US: LLM Model
      zh_Hans: LLM 模型
    form: form
    human_description:
      en_US: The LLM model to use for text analysis.
      zh_Hans: 用于文本分析的 LLM 模型。
    llm_description: The LLM model to use for text analysis.
  - name: upload_file
    type: file
    required: true
    label:
      en_US: File
      zh_Hans: 上传文件
    form: llm
    human_description:
      en_US: The Excel or CSV file to analyze.
      zh_Hans: 要分析的 Excel 或 CSV 文件。
    llm_description: The Excel or CSV file to analyze.
  - name: sheet_number
    type: number
    required: true
    label:
      en_US: Sheet Number
      zh_Hans: Sheet页码
    form: llm
    human_description:
      en_US: The sheet number to process (must be greater than 0).
      zh_Hans: 要处理的sheet页码（必须大于0）。
    llm_description: The sheet number to process (must be greater than 0).
    default: 1
    min: 1
  - name: input_columns
    type: string
    required: true
    label:
      en_US: Input Columns (e.g. A2,B2 or A2:A12,B2:B12)
      zh_Hans: 输入多列 (逗号分隔，例如 A2,B2 或 A2:A12,B2:B12）
    form: llm
    human_description:
      en_US: Multiple column coordinates to analyze text from, separated by commas.
      zh_Hans: 要分析文本的多列坐标，用逗号分隔。
    llm_description: Multiple column coordinates to analyze text from.
  - name: output_column
    type: string
    required: true
    label:
      en_US: Output Column (e.g. F2 or F2:F10)
      zh_Hans: 输出列坐标 (例如 F2 或 F2:F10）
    form: llm
    human_description:
      en_US: The column coordinates to write analysis results to.
      zh_Hans: 写入分析结果的列坐标。
    llm_description: The column coordinates to write analysis results to.
  - name: prompt
    type: string
    required: true
    label:
      en_US: Prompt
      zh_Hans: 提示词指令
    form: llm
    human_description:
      en_US: Instructions for LLM to analyze data.
      zh_Hans: 给 LLM 的指令用于分析数据。
    llm_description: Instructions for LLM to analyze data.
extra:
  python:
    source: tools/multi_column_text_analysis.py