identity:
  name: excel_manipulator
  author: sawyer-shi
  label:
    en_US: AI Intelligent Table Manipulation--Output Excel
    zh_Hans: AI自由操控表格数据--输出Excel
description:
  human:
    en_US: Use AI to intelligently modify, clean, or calculate Excel data (e.g., "Delete rows where Age < 18", "Deduplicate", "Add calculated columns"). Supports valid Python Pandas operations.
    zh_Hans: 通过 AI 智能修改、清洗或计算 Excel 数据（例如："删除年龄小于18的行"、"去除重复项"、"新增计算列"）。支持所有合法的 Python Pandas 操作。
  llm: Use this tool to programmatically modify, clean, or calculate data in Excel files using Python Pandas logic generated by LLM.
class_name: ExcelManipulatorTool
parameters:
  - name: upload_file
    type: file
    required: true
    label:
      en_US: Excel/CSV File
      zh_Hans: 上传 Excel/CSV 文件
    form: llm
    human_description:
      en_US: The file to be processed.
      zh_Hans: 需要处理的文件。
    llm_description: The Excel/CSV file to manipulate.
  - name: sheet_number
    type: number
    required: true
    label:
      en_US: Sheet Number
      zh_Hans: Sheet页码
    form: llm
    default: 1
    min: 1
    human_description:
      en_US: The sheet number to operate on (starts from 1).
      zh_Hans: 要操作的 Sheet 页码（从1开始）。
    llm_description: The sheet number to operate on (must be greater than 0).
  - name: prompt
    type: string
    required: true
    label:
      en_US: Manipulation Instruction
      zh_Hans: 操作指令
    form: llm
    placeholder:
      en_US: "e.g. Remove duplicate emails and calculate Sales * Price as Revenue"
      zh_Hans: "例如：去除邮箱重复的行，并计算 销量 * 单价 存入‘总收入’列"
    human_description:
      en_US: Describe how you want to modify the table.
      zh_Hans: 描述你想如何修改表格数据。
    llm_description: Detailed instruction on how to modify the dataframe.
  - name: output_filename
    type: string
    required: false
    label:
      en_US: Output Filename
      zh_Hans: 输出文件名
    form: llm
    placeholder:
      en_US: "result.xlsx"
      zh_Hans: "处理结果.xlsx"
    human_description:
      en_US: Specify the name of the downloaded file (optional).
      zh_Hans: 指定下载文件的名称（选填，默认为原文件名_modified）。
    llm_description: Custom filename for the output file.
  - name: model_config
    type: model-selector
    scope: llm
    required: true
    label:
      en_US: Model
      zh_Hans: 决策模型
    form: form
    human_description:
      en_US: LLM model to use for generating Python Pandas code.
      zh_Hans: 用于生成 Python Pandas 代码的 LLM 模型。
    llm_description: LLM model to use for generating Python Pandas code.
extra:
  python:
    source: tools/excel_manipulator.py