identity:
  author: "sawyer-shi"
  name: multi_column_image_analysis
  label:
    en_US: Multi Column Image Analysis--Output Excel
    zh_Hans: 多列图片信息分析--输出Excel
description:
  human:
    en_US: Analyze multiple images with prompt.
    zh_Hans: 对多列图片URL进行联合视觉分析。
  llm: Analyze multiple images with prompt.
class_name: MultiColumnImageAnalysisTool
parameters:
  - name: model_config
    type: model-selector
    scope: llm
    required: true
    label:
      en_US: Vision Model
      zh_Hans: 视觉大模型
    form: form
    human_description:
      en_US: The vision model to use for image analysis.
      zh_Hans: 用于图片分析的视觉大模型。
    llm_description: The vision model to use for image analysis.
  - name: upload_file
    type: file
    required: true
    label:
      en_US: File
      zh_Hans: 上传文件
    form: llm
    human_description:
      en_US: The Excel or CSV file containing image URLs.
      zh_Hans: 包含图片URL的 Excel 或 CSV 文件。
    llm_description: The Excel or CSV file containing image URLs.
  - name: sheet_number
    type: number
    required: true
    label:
      en_US: Sheet Number
      zh_Hans: Sheet页码
    form: llm
    human_description:
      en_US: The sheet number to process (must be greater than 0).
      zh_Hans: 要处理的sheet页码（必须大于0）。
    llm_description: The sheet number to process (must be greater than 0).
    default: 1
    min: 1
  - name: image_columns
    type: string
    required: true
    label:
      en_US: Image Columns (e.g. A2,B2 or A2:A12,B2:B12)
      zh_Hans: 图片所在的多列 (逗号分隔，例如 A2,B2 或 A2:A12,B2:B12）
    form: llm
    human_description:
      en_US: Multiple column coordinates containing image URLs, separated by commas.
      zh_Hans: 包含图片URL的多列坐标，用逗号分隔。
    llm_description: Multiple column coordinates containing image URLs.
  - name: output_column
    type: string
    required: true
    label:
      en_US: Output Column (e.g. F2 or F2:F10)
      zh_Hans: 输出列坐标 (例如 F2 或 F2:F10）
    form: llm
    human_description:
      en_US: The column coordinates to write analysis results to.
      zh_Hans: 写入分析结果的列坐标。
    llm_description: The column coordinates to write analysis results to.
  - name: prompt
    type: string
    required: true
    label:
      en_US: Prompt
      zh_Hans: 提示词指令
    form: llm
    human_description:
      en_US: Instructions for vision model to analyze images.
      zh_Hans: 给视觉大模型的指令用于分析图片。
    llm_description: Instructions for vision model to analyze images.
  - name: output_file_name
    type: string
    required: false
    label:
      en_US: Output File Name
      zh_Hans: 输出文件名
    form: llm
    human_description:
      en_US: The name of the output Excel file (without extension). If not provided, the original file name will be used.
      zh_Hans: 输出Excel文件的名称（不带扩展名）。如果不提供，将使用原始文件名。
    llm_description: The name of the output Excel file (without extension). If not provided, the original file name will be used.
extra:
  python:
    source: tools/multi_column_image_analysis.py